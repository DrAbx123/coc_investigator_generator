# 克苏鲁调查员生成器 (Call of Cthulhu Investigator Generator)

一个基于PyQt6的克苏鲁神话调查员生成工具，可以随机或自定义生成符合克苏鲁神话7版规则的调查员角色。

## 功能特点

- 随机生成调查员角色
- 自定义创建调查员角色
- 调整调查员属性、技能和背景
- 保存和加载调查员数据
- 导出调查员角色为文本格式
- 职业选择系统，包含多种预设职业
- 完整的技能系统，遵循克苏鲁的呼唤第七版规则
- 衍生属性自动计算（生命值、魔法值、理智值等）
- 增强语言技能系统，包括语言族群和技能转移
- 技能详情工具提示，鼠标悬停即可查看详细信息
- 背景故事和个人特质生成
- 装备管理系统
- 角色卡打印功能，支持标准打印设置对话框

## 最新更新

- **技能详情工具提示**：当鼠标悬停在技能名称或数值上时，会显示该技能的详细信息，包括基础值、描述、语言等级含义、语系信息和技能转移规则。
- **增强语言技能系统**：实现了完整的语言技能转移规则，同语系语言之间知识自动转移。
- **语言技能过滤**：技能表格增加了语言技能过滤选项，方便查看和管理所有语言技能。
- **语言技能转移规则查看**：添加了专门的按钮显示语言技能转移规则的详细说明。
- **打印功能增强**：角色卡打印功能现在支持标准打印对话框，允许用户选择打印机和打印设置。
- **技能变化高亮**：当语言技能因技能转移规则而改变时，相关技能会被高亮显示，并显示变化数值。

## 技能系统

本程序实现了克苏鲁的呼唤（CoC）第七版的完整技能系统：

- **基础技能**：每个技能都有基础值，代表未经训练时的能力水平
- **技能专攻**：某些广范围技能（如格斗、艺术/手艺、科学、生存等）可细分为专业领域
- **技能检定**：支持常规、困难和极难三种难度等级的技能检定
- **技能成长**：成功使用技能后可获得成长机会
- **对抗技能**：实现了技能间的对抗机制
- **技能转移**：可选规则允许相关专业技能之间的经验转移

技能分为多种类别：
- 知识类（如历史、科学、语言等）
- 社交类（如取悦、话术、恐吓、说服等）
- 战斗类（如格斗、射击等）
- 感知类（如侦查、聆听等）
- 身体类（如闪避、游泳、攀爬等）
- 技能类（如急救、驾驶、机械维修等）

## 语言技能系统

程序实现了增强的语言技能系统，包括：

- **语言族群关系**：语言被分为不同的语系（如日耳曼语族、罗曼语族、斯拉夫语族等），同一语系的语言之间有知识转移
- **技能转移规则**：
  - 当一名角色首次将一门语言（除了母语）提升到50%，同系语言都会提升至10%（但不会超过已有水平）
  - 当角色首次将一门语言提升到90%，同系语言会再次提升10%（但不会高于已有水平）
- **语言能力等级**：
  - 5%：能够正确地辨认出这门语言
  - 10%：可以交流简单的想法
  - 30%：可以对社交上的需求进行理解
  - 50%：可以进行流畅的交流
  - 75%：可以将这门语言说得像是本地人一样
- **母语自动设置**：根据调查员的出生地自动设置合适的母语
- **语言技能信息工具**：提供了命令行工具查看语言族群关系和技能转移规则
- **技能详情浮窗**：鼠标悬停在语言技能上时，会显示详细的语言技能信息
- **语言技能过滤**：可以快速筛选出所有语言技能进行管理
- **变化提示系统**：当一个语言技能的提升导致相关语言技能提升时，会显示通知并高亮显示变化

使用以下命令查看语言技能系统信息：
```
python language_skill_info.py info
```

测试语言技能转移规则：
```
python language_skill_info.py test
```

## 项目结构

```
cthulhu_investigator_generator/
│
├── main.py                 # 主程序入口
├── requirements.txt        # 项目依赖
│
├── core/                   # 核心逻辑
│   ├── __init__.py         # 包初始化
│   ├── config.py           # 配置管理
│   ├── investigator.py     # 调查员类
│   ├── attributes.py       # 属性管理
│   ├── skills.py           # 技能管理
│   ├── occupations.py      # 职业管理
│   ├── backgrounds.py      # 背景管理
│   └── generator.py        # 调查员生成器
│
├── gui/                    # 图形界面
│   ├── __init__.py         # 包初始化
│   ├── main_window.py      # 主窗口
│   └── tabs/               # 选项卡组件
│       ├── __init__.py     # 包初始化
│       ├── attribute_tab.py # 属性选项卡
│       ├── occupation_tab.py # 职业选项卡
│       ├── skills_tab.py   # 技能选项卡
│       ├── background_tab.py # 背景选项卡
│       ├── equipment_tab.py # 装备选项卡
│       └── summary_tab.py  # 摘要选项卡
│
├── utils/                  # 实用工具
│   ├── __init__.py         # 包初始化
│   ├── dice.py             # 骰子模拟器
│   └── file_handler.py     # 文件处理工具
│
└── data/                   # 数据文件
    ├── skills.json         # 技能数据
    ├── occupations.json    # 职业数据
    └── backgrounds.json    # 背景数据
```

## 角色属性系统

调查员的核心属性包括：
- 力量（STR）：衡量角色的物理力量
- 体质（CON）：衡量角色的健康与耐力
- 体型（SIZ）：衡量角色的体格大小
- 敏捷（DEX）：衡量角色的反应速度和协调性
- 外貌（APP）：衡量角色的魅力与外表
- 智力（INT）：衡量角色的推理能力和直觉
- 意志（POW）：衡量角色的精神力量
- 教育（EDU）：衡量角色的学识与知识广度
- 幸运（Luck）：衡量角色的好运与命运

衍生属性包括：
- 生命值（HP）：角色可以承受的伤害
- 魔法值（MP）：施放法术的能量
- 理智值（SAN）：心理健康程度
- 伤害加值（DB）：根据力量和体型决定的额外伤害
- 体格（Build）：影响战斗和物理行为
- 移动速度（MOV）：角色的移动能力

## 职业系统

提供多种预设职业，每种职业：
- 有特定的描述和背景
- 具备特定的职业技能列表
- 有信用评级范围
- 有独特的技能点计算公式

## 使用方法

1. 确保安装了Python 3.x和PyQt6
2. 安装依赖：`pip install -r requirements.txt`
3. 运行主程序：`python main.py`
4. 使用GUI界面创建和管理调查员角色

以下是使用技巧：
- 在技能表格中，将鼠标悬停在技能名称或数值上可查看详细信息
- 使用"语言技能"过滤选项可以快速查看所有语言技能
- 点击"语言技能转移规则"按钮可查看详细的语言技能转移规则说明
- 在打印角色卡时，可以通过打印对话框选择合适的打印机和设置

## 环境要求

- Python 3.8+
- PyQt6
- 其他依赖见requirements.txt

## 孤注一掷系统

程序实现了CoC规则中的"孤注一掷"机制，允许玩家在危急时刻冒险一搏：
- 当技能检定失败时，可选择孤注一掷进行第二次尝试
- 成功会带来额外好处，失败则会导致更严重的后果
- 对不同技能有特定的孤注一掷示例和失败结果

## 开发目标

- [x] 增强语言技能系统
- [x] 改进技能信息显示
- [x] 优化打印功能
- [ ] 增加更多预设调查员模板
- [ ] 支持战斗模拟功能
- [ ] 增加法术系统
- [ ] 完善道具系统
- [ ] 添加故事模式
- [ ] 多语言支持
- [ ] 支持Android/iOS移动平台

## 贡献

欢迎贡献代码、报告问题或提出新功能建议。

## 许可

本项目采用MIT许可证。
